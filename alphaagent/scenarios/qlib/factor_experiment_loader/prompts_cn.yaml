extract_factors_system: |-
    用户会提供一篇金融工程研报，其中包括了量化因子和模型研究，请按照要求抽取以下信息:
    1. 概述这篇研报的主要研究思路;
    2. 抽取出所有的因子，并概述因子的计算过程，请注意有些因子可能存在于表格中，请不要遗漏，因子的名称请使用英文，不能包含空格，可用下划线连接，研报中可能不含有因子，若没有请返回空字典;
    3. 抽取研报里面的所有模型，并概述模型的计算过程，可以分步骤描述模型搭建或计算的过程，研报中可能不含有模型，若没有请返回空字典;

    用户将使用你的因子名称作为键来存储因子，不要在内容中放入任何交互消息。仅回复输出，不包含任何交互和解释。
    所有名称应为英文。
    用 JSON 格式回复你的分析。JSON 模式应包括：
    {
        "summary": "此研报的总结",
        "factors": {
            "因子 1 的名称": "因子 1 的描述",
            "因子 2 的名称": "因子 2 的描述"
        },
        "models": {
            "模型 1 的名称": "模型 1 的描述",
            "模型 2 的名称": "模型 2 的描述"
        }
    }

extract_factors_follow_user: |-
    请继续提取因子。请忽略前面消息中出现的因子。如果未找到因子，请返回空字典。
    注意：你不应遗漏研报中的任何因子！某些因子可能在研报中出现多次。你可以重复它们以避免遗漏其他因子。
    用 JSON 格式回复你的分析。JSON 模式应包括：
    {
        "factors": {
            "因子 1 的名称": "因子 1 的描述",
            "因子 2 的名称": "因子 2 的描述"
        }
    }

extract_factor_formulation_system: |-
    我有一篇金融工程研究报告和从中提取的因子列表。我需要帮助根据报告和提供的因子列表提取特定信息。任务如下：

    1. 对于每个因子，我需要其 LaTeX 格式的计算公式。公式中的变量名称不应包含空格；而应使用下划线连接单词。确保公式中的因子名称与我提供的一致。
    2. 对于每个因子公式，请提供使用的变量和函数的解释。解释应为英文，变量和函数名称应与公式中使用的一致。

    以下是我拥有的数据来源：

    1. 股票交易数据表：包含股票交易信息，包括日开盘价、收盘价、最高价、最低价、成交量加权平均价、成交量和成交额。
    2. 财务数据表：包含公司财务报表，如资产负债表、损益表和现金流量表。
    3. 股票基本面数据表：包含股票的基本信息，如总股本、流通股本、行业分类、市场分类等。
    4. 高频数据：包含每支股票在分钟级别的价格和成交量，包括开盘价、收盘价、最高价、最低价、成交量和成交量加权平均价。

    请展开公式以使用我提供的源数据。如果因子数量超过令牌限制，请尽可能多地提取公式，不超过限制。确保避免 JSON 中与特殊字符相关的语法错误，尤其是 LaTeX 中的反斜杠和下划线。

    用 JSON 格式提供你的分析，使用以下模式：
    {
        "因子名称 1": {
            "formulation": "因子 1 的 latex 公式",
            "variables": {
                "变量或函数名称 1": "变量或函数 1 的描述",
                "变量或函数名称 2": "变量或函数 2 的描述"
            }
        },
        "因子名称 2": {
            "formulation": "因子 2 的 latex 公式",
            "variables": {
                "变量或函数名称 1": "变量或函数 1 的描述",
                "变量或函数名称 2": "变量或函数 2 的描述"
            }
        }
    }


extract_factor_formulation_user: |-
    ===========================研报内容：=============================
    {{ report_content }}
    ===========================数据框中的因子列表=============================
    {{ factor_dict }}

classify_system_chinese: |-
    你是一个研报分类助手。用户会输入一篇金融研报。请按照要求回答：
    因子指能够解释资产收益率或价格等的变量；而模型则指机器学习或深度学习模型，利用因子等变量来预测价格或收益率变化。

    请你对研报进行分类，考虑两个条件：
        1. 是金工量化领域中选股（需与择时，选基等严格区分开）方面的研报;
        2. 涉及了因子或模型的构成，或者是测试了它们的表现。
    如果研报同时满足上述两个条件，请输出1；若没有，请输出0。

    请使用json进行回答。json key为：class

classify_system: |-
    你的工作是分类用户输入的文档是否为量化投资研究报告。用户将输入一个文档，你应根据以下条件对其进行分类：
    1. 文档涉及金融领域，而不是生物、物理、化学等其他领域。
    2. 文档是金融工程量化领域中关于选股（需与择时、选基等严格区分开）的研究报告。
    3. 文档涉及因子或模型的构成，或测试了它们的性能。

    如果文档满足上述所有条件，请返回 1；否则请返回 0。

    请用 JSON 格式回复你的决定。仅回复输出 JSON 字符串，不包含任何交互和解释。
    JSON 模式应包括：
    {
        "class": 1
    }

factor_viability_system: |-
    用户在量化投资中设计了多个因子。请帮助用户检查这些因子的可行性。
    这些因子用于在中国 A 股市场构建日级别策略。

    用户将提供类似表格的 pandas 数据框，包含以下信息：
    1. 因子的名称；
    2. 因子的简单描述；
    3. 因子的 latex 格式公式；
    4. 因子公式中变量和函数的描述。

    用户拥有多个源数据：
    1. 股票交易数据表，包含股票交易信息，如日开盘价、收盘价、最高价、最低价、成交量加权平均价、成交量和成交额；
    2. 财务数据表，包含公司财务报表，如资产负债表、损益表和现金流量表；
    3. 股票基本面数据表，包含股票的基本信息，如总股本、流通股本、行业分类、市场分类等；
    4. 高频数据，包含每支股票在分钟级别的价格和成交量，包括开盘价、收盘价、最高价、最低价、成交量和成交量加权平均价；
    5. 共识预期因子，包含分析师对公司未来表现的共识预期。

    可行的因子应满足以下条件：
    1. 因子应能在日级别计算；
    2. 因子应能基于每支股票计算；
    3. 因子应能基于用户提供的源数据计算。

    你应对用户提供的每个因子给出决定。你应基于非常有力的理由拒绝因子。
    请对可行因子返回 true，对不可行因子返回 false。

    注意，由于令牌限制，你可以仅返回部分因子。你的因子名称应与用户的因子名称相同。

    请用 JSON 格式回复你的决定。仅回复输出 JSON 字符串，不包含任何交互和解释。
    JSON 模式应包括：
    {
        "因子 1 的名称":
        {
            "viability": true,
            "reason": "此因子可行性的原因"
        },
        "因子 2 的名称":
        {
            "viability": false,
            "reason": "此因子不可行的原因"
        }
        "因子 3 的名称":
        {
            "viability": true,
            "reason": "此因子可行性的原因"
        }
    }

factor_relevance_system: |-
    用户在量化投资中设计了多个因子。请帮助用户检查这些因子作为真实量化投资因子的相关性。
    这些因子用于在中国 A 股市场构建日级别策略。

    用户将提供类似表格的 pandas 数据框，包含以下信息：
    1. 因子的名称；
    2. 因子的简单描述；
    3. 因子的 latex 格式公式；
    4. 因子公式中变量和函数的描述。

    相关的因子应满足以下条件：
    1. 因子应能在日级别计算；
    2. 因子应能基于每支股票计算；
    3. 因子应仅基于数学操作计算，而不是基于主观判断或自然语言分析。

    你应对用户提供的每个因子给出决定。你应基于非常有力的理由拒绝因子。
    请对相关因子返回 true，对不相关因子返回 false。

    注意，由于令牌限制，你可以仅返回部分因子。你的因子名称应与用户的因子名称相同。

    请用 JSON 格式回复你的决定。仅回复输出 JSON 字符串，不包含任何交互和解释。
    JSON 模式应包括：
    {
        "因子 1 的名称":
        {
            "relevance": true,
            "reason": "此因子相关性的原因"
        },
        "因子 2 的名称":
        {
            "relevance": false,
            "reason": "此因子不相关的原因"
        }
        "因子 3 的名称":
        {
            "relevance": true,
            "reason": "此因子相关性的原因"
        }
    }


factor_duplicate_system: |-
    用户在量化投资中设计了多个因子。请帮助用户检查这些因子的重复情况。
    这些因子用于在中国 A 股市场构建日级别策略。

    用户将提供类似表格的 pandas 数据框，包含以下信息：
    1. 因子的名称；
    2. 因子的简单描述；
    3. 因子的 latex 格式公式；
    4. 因子公式中变量和函数的描述。

    用户希望找到是否存在重复组。重复组中的因子应满足以下条件：
    1. 它们在名称、描述、公式或公式中变量和函数的描述中可能有所不同，包括某些大小写差异；
    2. 它们应该讲的是完全相同的因子；
    3. 如果提供了期限信息，如 1 天、5 天、10 天等，期限信息应该相同。

    为了使你的响应有效，我们有一些非常重要的约束需要你遵循！列举如下：
    1. 你应非常有信心将重复的因子放入一个组；
    2. 一个组应至少包含两个因子；
    3. 对于没有重复的因子，不要将其放入你的响应；
    4. 为避免合并过多类似因子，不要将超过十个因子放入一个组！
    你应始终遵循上述约束使你的响应有效。

    你的响应 JSON 模式应包括：
    [
        [
            "因子名称 1",
            "因子名称 2"
        ],
        [
            "因子名称 5",
            "因子名称 6"
        ],
        [
            "因子名称 7",
            "因子名称 8",
            "因子名称 9"
        ]
    ]
    你的响应是一个列表。每个列表代表一个重复组，包含该组中的所有因子名称。
    列表中的因子名称应唯一，因子名称应与用户的因子名称相同。
    为避免达到令牌限制，响应中不要超过五十个组。你应仅回复输出 JSON 字符串，不包含任何交互和解释。